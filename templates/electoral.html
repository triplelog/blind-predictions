<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
    {% block meta %}
    <meta name="description" content=".">    <title>Blind Predictions</title>  
    {% endblock %}
    
<link rel="icon" type="image/png" href="../img/fav.png">

{% block stylesheets %}
{% endblock %}


<style>
div.container {
	{% block borderRadius %}
	{% endblock %}
}



{% block titleCSS %}
{% endblock %}


{% block moreCSS %}
{% endblock %}



</style>

</head>
<body>

{% block bodyStart %}
{% endblock %}
<div class="container">
	<form action="../map" method="post">
	{% block dataTable %}
	{% endblock %}
	<button onclick="predictNow()" type="submit">Predict</button>
	</form>
</div>
<div id="footer">
	{% block footer %}
	{% endblock %}
</div>
{% block scripts %}
{% endblock %}
<script>
var myWorker = new Worker('js/wasmworker.js');
myWorker.onmessage = function(e) {
	if (e.data == "ready"){
		setTimeout(updateMarkdown,50);
	}
	else if (e.data[0] == "prediction"){
		alert(e.data[1]);
	}
}
function predictNow(){
	var rows = document.querySelectorAll('#dataTable tr');
	for (var i=0;i<rows.length;i++){
		
		if (rows[i].querySelector('input').value != ""){
			var state = rows[i].getAttribute('data-id');
			var year = rows[i].getAttribute('data-year');
			var party = rows[i].getAttribute('data-party');
			var prob = parseFloat(rows[i].querySelector('input').value);
			if (party == "R"){
				prob = 1-parseFloat(rows[i].querySelector('input').value);
			}
			myWorker.postMessage(["update",state,prob,year]);
		}
		
	}
	
	myWorker.postMessage(["predict"]);
}


</script>
</body>
</html>